var v=Object.defineProperty;var i=(r,e)=>v(r,"name",{value:e,configurable:!0});import{ClobClient as E}from"@polymarket/clob-client";import{ExchangeOrderBuilder as A}from"@polymarket/order-utils";var z={exchange:"0xdFE02Eb6733538f8Ea35D585af8DE5958AD99E40",negRiskAdapter:"0xd91E80cF2E7be2e162c6513ceD06f1dD0dA35296",negRiskExchange:"0xC5d563A36AE78145C45a50134d48A1215220f80a",collateral:"0x9c4e1703476e875070ee25b56a58b008cfb8fa78",conditionalTokens:"0x69308FB512518e39F9b16112fA8d994F4e2Bf8bB"},U={exchange:"0x4bFb41d5B3570DeFd03C39a9A4D8dE6Bd8B8982E",negRiskAdapter:"0xd91E80cF2E7be2e162c6513ceD06f1dD0dA35296",negRiskExchange:"0xC5d563A36AE78145C45a50134d48A1215220f80a",collateral:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174",conditionalTokens:"0x4D97DCd97eC945f40cF65F87097ACe5EA0476045"},h={"0.1":{price:1,size:2,amount:3},"0.01":{price:2,size:2,amount:4},"0.001":{price:3,size:2,amount:5},"0.0001":{price:4,size:2,amount:6}},b=i(r=>{switch(r){case 137:return U;case 80002:return z;default:throw new Error(`Invalid network: ${r}`)}},"getContractConfig");var p=class{constructor(e){this.cfg=e;let o=b(this.cfg.chainId);this.builderExchange=new A(o.exchange,this.cfg.chainId,this.cfg.signer),this.builderNegRisk=new A(o.negRiskExchange,this.cfg.chainId,this.cfg.signer)}static{i(this,"OrderBuilder")}builderExchange;builderNegRisk};import{Side as l,SignatureType as C}from"@polymarket/order-utils";import{OrderType as J}from"@polymarket/clob-client";import{zeroAddress as M}from"viem";import{parseUnits as L}from"viem";var d=i(r=>{if(Number.isInteger(r))return 0;let e=r.toString().split(".");return e.length<=1?0:e[1].length},"decimalPlaces"),O=i((r,e)=>d(r)<=e?r:Math.round((r+Number.EPSILON)*10**e)/10**e,"roundNormal"),c=i((r,e)=>d(r)<=e?r:Math.floor(r*10**e)/10**e,"roundDown"),g=i((r,e)=>d(r)<=e?r:Math.ceil(r*10**e)/10**e,"roundUp"),x=i((r,e)=>{let o=parseFloat(e);return r>=o&&r<=1-o},"priceValid");function y(r,e,o,t){let s=O(o,t.price);if(r===l.BUY){let a=c(e,t.size),n=a*s;return d(n)>t.amount&&(n=g(n,t.amount+4),d(n)>t.amount&&(n=c(n,t.amount))),{rawMakerAmt:n,rawTakerAmt:a,side:l.BUY}}else if(r===l.SELL){let a=c(e,t.size),n=a*s;return d(n)>t.amount&&(n=g(n,t.amount+4),d(n)>t.amount&&(n=c(n,t.amount))),{rawMakerAmt:a,rawTakerAmt:n,side:l.SELL}}throw new Error(`Invalid side: ${r}`)}i(y,"getOrderRawAmounts");function m(r){return L(r.toString(),6).toString()}i(m,"toCollateralUnits");function k(r){let{signerAddress:e,makerAddress:o,userOrder:t,resolved:s}=r,a=r.signatureType??C.EOA;if(!x(t.price,s.tickSize))throw new Error(`invalid price (${t.price}), min: ${s.tickSize} - max: ${1-parseFloat(s.tickSize)}`);let n;typeof t.taker<"u"&&t.taker?n=t.taker:n=M;let I=h[s.tickSize],{rawMakerAmt:R,rawTakerAmt:D,side:N}=y(t.side,t.size,t.price,I),P=m(R),B=m(D);return{maker:o,taker:n,tokenId:t.tokenID,makerAmount:P,takerAmount:B,side:N,feeRateBps:(s.feeRateBps??"0").toString(),nonce:(t.nonce??"0").toString(),signer:e,expiration:(t.expiration??0).toString(),signatureType:a}}i(k,"buildUnsignedOrder");var u=class{constructor(e,o,t,s,a){this.funderAddress=e;this.signerWallet=o;this.chainId=t;this.signatureType=s;this.getClobClient=a;this.signerAddress=this.signerWallet.address,this.orderBuilder=new p({signer:this.signerWallet,chainId:this.chainId})}static{i(this,"OrderFunctions")}signerAddress;orderBuilder;async createSignedOrder(e,o){let t=k({signerAddress:this.signerAddress,makerAddress:this.funderAddress,signatureType:this.signatureType,userOrder:e,resolved:o});return o.negRisk?this.orderBuilder.builderNegRisk.buildSignedOrder(t):this.orderBuilder.builderExchange.buildSignedOrder(t)}async postSignedOrder(e,o,t){return(await(await this.getClobClient()).postOrders([e],o,t))[0]}async postSignedOrders(e,o,t){return await(await this.getClobClient()).postOrders(e,o,t)}};var S="https://clob.polymarket.com",f=137,T=2,w=class{constructor(e,o){this.funderAddress=e;this.signerWallet=o;this.order=new u(this.funderAddress,this.signerWallet,f,T,this.getClobClient.bind(this))}static{i(this,"ClobClient")}auth=null;instance=null;order;async getAuth(){if(this.auth)return this.auth;let e=new E(S,f,this.signerWallet);return this.auth=await e.createOrDeriveApiKey(),this.auth}async getClobClient(){if(this.instance)return this.instance;let e=await this.getAuth();return this.instance=new E(S,f,this.signerWallet,e,T,this.funderAddress),this.instance}};export{w as ClobClient,J as OrderType,l as Side,C as SignatureType};
