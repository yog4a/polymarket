var I=Object.defineProperty;var o=(e,r)=>I(e,"name",{value:r,configurable:!0});import{ExchangeOrderBuilder as b}from"@polymarket/order-utils";var D={exchange:"0xdFE02Eb6733538f8Ea35D585af8DE5958AD99E40",negRiskAdapter:"0xd91E80cF2E7be2e162c6513ceD06f1dD0dA35296",negRiskExchange:"0xC5d563A36AE78145C45a50134d48A1215220f80a",collateral:"0x9c4e1703476e875070ee25b56a58b008cfb8fa78",conditionalTokens:"0x69308FB512518e39F9b16112fA8d994F4e2Bf8bB"},N={exchange:"0x4bFb41d5B3570DeFd03C39a9A4D8dE6Bd8B8982E",negRiskAdapter:"0xd91E80cF2E7be2e162c6513ceD06f1dD0dA35296",negRiskExchange:"0xC5d563A36AE78145C45a50134d48A1215220f80a",collateral:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174",conditionalTokens:"0x4D97DCd97eC945f40cF65F87097ACe5EA0476045"},m={"0.1":{price:1,size:2,amount:3},"0.01":{price:2,size:2,amount:4},"0.001":{price:3,size:2,amount:5},"0.0001":{price:4,size:2,amount:6}},f=o(e=>{switch(e){case 137:return N;case 80002:return D;default:throw new Error(`Invalid network: ${e}`)}},"getContractConfig");var l=class{constructor(r){this.cfg=r;let i=f(this.cfg.chainId);this.builderExchange=new b(i.exchange,this.cfg.chainId,this.cfg.signer),this.builderNegRisk=new b(i.negRiskExchange,this.cfg.chainId,this.cfg.signer)}static{o(this,"OrderBuilder")}builderExchange;builderNegRisk};import{Side as c,SignatureType as A}from"@polymarket/order-utils";import{OrderType as K}from"@polymarket/clob-client";import{zeroAddress as z}from"viem";import{parseUnits as B}from"viem";var d=o(e=>{if(Number.isInteger(e))return 0;let r=e.toString().split(".");return r.length<=1?0:r[1].length},"decimalPlaces"),O=o((e,r)=>d(e)<=r?e:Math.round((e+Number.EPSILON)*10**r)/10**r,"roundNormal"),p=o((e,r)=>d(e)<=r?e:Math.floor(e*10**r)/10**r,"roundDown"),g=o((e,r)=>d(e)<=r?e:Math.ceil(e*10**r)/10**r,"roundUp"),h=o((e,r)=>{let i=parseFloat(r);return e>=i&&e<=1-i},"priceValid");function x(e,r,i,t){let s=O(i,t.price);if(e===c.BUY){let a=p(r,t.size),n=a*s;return d(n)>t.amount&&(n=g(n,t.amount+4),d(n)>t.amount&&(n=p(n,t.amount))),{rawMakerAmt:n,rawTakerAmt:a,side:c.BUY}}else if(e===c.SELL){let a=p(r,t.size),n=a*s;return d(n)>t.amount&&(n=g(n,t.amount+4),d(n)>t.amount&&(n=p(n,t.amount))),{rawMakerAmt:a,rawTakerAmt:n,side:c.SELL}}throw new Error(`Invalid side: ${e}`)}o(x,"getOrderRawAmounts");function u(e){return B(e.toString(),6).toString()}o(u,"toCollateralUnits");function C(e){let{signerAddress:r,makerAddress:i,userOrder:t,resolved:s}=e,a=e.signatureType??A.EOA;if(!h(t.price,s.tickSize))throw new Error(`invalid price (${t.price}), min: ${s.tickSize} - max: ${1-parseFloat(s.tickSize)}`);let n;typeof t.taker<"u"&&t.taker?n=t.taker:n=z;let y=m[s.tickSize],{rawMakerAmt:E,rawTakerAmt:S,side:T}=x(t.side,t.size,t.price,y),w=u(E),R=u(S);return{maker:i,taker:n,tokenId:t.tokenID,makerAmount:w,takerAmount:R,side:T,feeRateBps:(s.feeRateBps??"0").toString(),nonce:(t.nonce??"0").toString(),signer:r,expiration:(t.expiration??0).toString(),signatureType:a}}o(C,"buildUnsignedOrder");var k=class{constructor(r,i,t,s,a){this.funderAddress=r;this.signerWallet=i;this.chainId=t;this.signatureType=s;this.getClobClient=a;this.signerAddress=this.signerWallet.address,this.orderBuilder=new l({signer:this.signerWallet,chainId:this.chainId})}static{o(this,"OrderFunctions")}signerAddress;orderBuilder;async createSignedOrder(r,i){let t=C({signerAddress:this.signerAddress,makerAddress:this.funderAddress,signatureType:this.signatureType,userOrder:r,resolved:i});return i.negRisk?this.orderBuilder.builderNegRisk.buildSignedOrder(t):this.orderBuilder.builderExchange.buildSignedOrder(t)}async postSignedOrder(r,i,t){return(await(await this.getClobClient()).postOrders([r],i,t))[0]}async postSignedOrders(r,i,t){return await(await this.getClobClient()).postOrders(r,i,t)}};export{k as OrderFunctions};
