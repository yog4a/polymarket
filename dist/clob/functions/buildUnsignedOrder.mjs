var T=Object.defineProperty;var o=(e,r)=>T(e,"name",{value:r,configurable:!0});import{Side as p,SignatureType as f}from"@polymarket/order-utils";import{OrderType as L}from"@polymarket/clob-client";var g={"0.1":{price:1,size:2,amount:3},"0.01":{price:2,size:2,amount:4},"0.001":{price:3,size:2,amount:5},"0.0001":{price:4,size:2,amount:6}};import{zeroAddress as y}from"viem";import{parseUnits as R}from"viem";var a=o(e=>{if(Number.isInteger(e))return 0;let r=e.toString().split(".");return r.length<=1?0:r[1].length},"decimalPlaces"),A=o((e,r)=>a(e)<=r?e:Math.round((e+Number.EPSILON)*10**r)/10**r,"roundNormal"),m=o((e,r)=>a(e)<=r?e:Math.floor(e*10**r)/10**r,"roundDown"),d=o((e,r)=>a(e)<=r?e:Math.ceil(e*10**r)/10**r,"roundUp"),l=o((e,r)=>{let c=parseFloat(r);return e>=c&&e<=1-c},"priceValid");function x(e,r,c,t){let i=A(c,t.price);if(e===p.BUY){let s=m(r,t.size),n=s*i;return a(n)>t.amount&&(n=d(n,t.amount+4),a(n)>t.amount&&(n=m(n,t.amount))),{rawMakerAmt:n,rawTakerAmt:s,side:p.BUY}}else if(e===p.SELL){let s=m(r,t.size),n=s*i;return a(n)>t.amount&&(n=d(n,t.amount+4),a(n)>t.amount&&(n=m(n,t.amount))),{rawMakerAmt:s,rawTakerAmt:n,side:p.SELL}}throw new Error(`Invalid side: ${e}`)}o(x,"getOrderRawAmounts");function u(e){return R(e.toString(),6).toString()}o(u,"toCollateralUnits");function J(e){let{signerAddress:r,makerAddress:c,userOrder:t,resolved:i}=e,s=e.signatureType??f.EOA;if(!l(t.price,i.tickSize))throw new Error(`invalid price (${t.price}), min: ${i.tickSize} - max: ${1-parseFloat(i.tickSize)}`);let n;typeof t.taker<"u"&&t.taker?n=t.taker:n=y;let b=g[i.tickSize],{rawMakerAmt:k,rawTakerAmt:E,side:O}=x(t.side,t.size,t.price,b),C=u(k),S=u(E);return{maker:c,taker:n,tokenId:t.tokenID,makerAmount:C,takerAmount:S,side:O,feeRateBps:(i.feeRateBps??"0").toString(),nonce:(t.nonce??"0").toString(),signer:r,expiration:(t.expiration??0).toString(),signatureType:s}}o(J,"buildUnsignedOrder");export{J as buildUnsignedOrder};
