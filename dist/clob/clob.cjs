"use strict";var p=Object.defineProperty;var U=Object.getOwnPropertyDescriptor;var F=Object.getOwnPropertyNames;var L=Object.prototype.hasOwnProperty;var o=(r,e)=>p(r,"name",{value:e,configurable:!0});var M=(r,e)=>{for(var n in e)p(r,n,{get:e[n],enumerable:!0})},W=(r,e,n,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of F(e))!L.call(r,s)&&s!==n&&p(r,s,{get:()=>e[s],enumerable:!(t=U(e,s))||t.enumerable});return r};var _=r=>W(p({},"__esModule",{value:!0}),r);var j={};M(j,{ClobClient:()=>C});module.exports=_(j);var A=require("@polymarket/clob-client");var m=require("@polymarket/order-utils");var K={exchange:"0xdFE02Eb6733538f8Ea35D585af8DE5958AD99E40",negRiskAdapter:"0xd91E80cF2E7be2e162c6513ceD06f1dD0dA35296",negRiskExchange:"0xC5d563A36AE78145C45a50134d48A1215220f80a",collateral:"0x9c4e1703476e875070ee25b56a58b008cfb8fa78",conditionalTokens:"0x69308FB512518e39F9b16112fA8d994F4e2Bf8bB"},G={exchange:"0x4bFb41d5B3570DeFd03C39a9A4D8dE6Bd8B8982E",negRiskAdapter:"0xd91E80cF2E7be2e162c6513ceD06f1dD0dA35296",negRiskExchange:"0xC5d563A36AE78145C45a50134d48A1215220f80a",collateral:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174",conditionalTokens:"0x4D97DCd97eC945f40cF65F87097ACe5EA0476045"},O={"0.1":{price:1,size:2,amount:3},"0.01":{price:2,size:2,amount:4},"0.001":{price:3,size:2,amount:5},"0.0001":{price:4,size:2,amount:6}},y=o(r=>{switch(r){case 137:return G;case 80002:return K;default:throw new Error(`Invalid network: ${r}`)}},"getContractConfig");var u=class{constructor(e){this.cfg=e;let n=y(this.cfg.chainId);this.builderExchange=new m.ExchangeOrderBuilder(n.exchange,this.cfg.chainId,this.cfg.signer),this.builderNegRisk=new m.ExchangeOrderBuilder(n.negRiskExchange,this.cfg.chainId,this.cfg.signer)}static{o(this,"OrderBuilder")}builderExchange;builderNegRisk};var d=require("@polymarket/order-utils"),$=require("@polymarket/clob-client");var T=require("viem");var E=require("viem");var l=o(r=>{if(Number.isInteger(r))return 0;let e=r.toString().split(".");return e.length<=1?0:e[1].length},"decimalPlaces"),x=o((r,e)=>l(r)<=e?r:Math.round((r+Number.EPSILON)*10**e)/10**e,"roundNormal"),c=o((r,e)=>l(r)<=e?r:Math.floor(r*10**e)/10**e,"roundDown"),f=o((r,e)=>l(r)<=e?r:Math.ceil(r*10**e)/10**e,"roundUp"),k=o((r,e)=>{let n=parseFloat(e);return r>=n&&r<=1-n},"priceValid");function S(r,e,n,t){let s=x(n,t.price);if(r===d.Side.BUY){let a=c(e,t.size),i=a*s;return l(i)>t.amount&&(i=f(i,t.amount+4),l(i)>t.amount&&(i=c(i,t.amount))),{rawMakerAmt:i,rawTakerAmt:a,side:d.Side.BUY}}else if(r===d.Side.SELL){let a=c(e,t.size),i=a*s;return l(i)>t.amount&&(i=f(i,t.amount+4),l(i)>t.amount&&(i=c(i,t.amount))),{rawMakerAmt:a,rawTakerAmt:i,side:d.Side.SELL}}throw new Error(`Invalid side: ${r}`)}o(S,"getOrderRawAmounts");function h(r){return(0,E.parseUnits)(r.toString(),6).toString()}o(h,"toCollateralUnits");function w(r){let{signerAddress:e,makerAddress:n,userOrder:t,resolved:s}=r,a=r.signatureType??d.SignatureType.EOA;if(!k(t.price,s.tickSize))throw new Error(`invalid price (${t.price}), min: ${s.tickSize} - max: ${1-parseFloat(s.tickSize)}`);let i;typeof t.taker<"u"&&t.taker?i=t.taker:i=T.zeroAddress;let D=O[s.tickSize],{rawMakerAmt:N,rawTakerAmt:P,side:B}=S(t.side,t.size,t.price,D),v=h(N),z=h(P);return{maker:n,taker:i,tokenId:t.tokenID,makerAmount:v,takerAmount:z,side:B,feeRateBps:(s.feeRateBps??"0").toString(),nonce:(t.nonce??"0").toString(),signer:e,expiration:(t.expiration??0).toString(),signatureType:a}}o(w,"buildUnsignedOrder");var g=class{constructor(e,n,t,s,a){this.funderAddress=e;this.signerWallet=n;this.chainId=t;this.signatureType=s;this.getClobClient=a;this.signerAddress=this.signerWallet.address,this.orderBuilder=new u({signer:this.signerWallet,chainId:this.chainId})}static{o(this,"OrderFunctions")}signerAddress;orderBuilder;async createSignedOrder(e,n){let t=w({signerAddress:this.signerAddress,makerAddress:this.funderAddress,signatureType:this.signatureType,userOrder:e,resolved:n});return n.negRisk?this.orderBuilder.builderNegRisk.buildSignedOrder(t):this.orderBuilder.builderExchange.buildSignedOrder(t)}async postSignedOrder(e,n,t){return(await(await this.getClobClient()).postOrders([e],n,t))[0]}async postSignedOrders(e,n,t){return await(await this.getClobClient()).postOrders(e,n,t)}};var I="https://clob.polymarket.com",b=137,R=2,C=class{constructor(e,n){this.funderAddress=e;this.signerWallet=n;this.order=new g(this.funderAddress,this.signerWallet,b,R,this.getClobClient.bind(this))}static{o(this,"ClobClient")}auth=null;instance=null;order;async getAuth(){if(this.auth)return this.auth;let e=new A.ClobClient(I,b,this.signerWallet);return this.auth=await e.createOrDeriveApiKey(),this.auth}async getClobClient(){if(this.instance)return this.instance;let e=await this.getAuth();return this.instance=new A.ClobClient(I,b,this.signerWallet,e,R,this.funderAddress),this.instance}};0&&(module.exports={ClobClient});
